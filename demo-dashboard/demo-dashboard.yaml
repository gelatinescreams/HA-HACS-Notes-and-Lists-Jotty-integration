title: Notes
icon: mdi:notebook
views:
  - title: Notes
    path: notes
    icon: mdi:note-text
    sections:
      - type: grid
        cards:
          - type: entities
            title: New Note
            entities:
              - entity: input_text.jotty_note_title
                name: Title
              - type: custom:lovelace-multiline-text-input-card
                buttons: false
                clear: false
                paste: false
                save: false
                entity: input_text.jotty_note_content
                autosave: true
                show_success_messages: false
            footer:
              type: buttons
              entities:
                - entity: script.jotty_create_note
                  name: Create
                  icon: mdi:plus-circle
                  tap_action:
                    action: call-service
                    service: script.jotty_create_note
            grid_options:
              columns: full
              rows: auto
          - type: entities
            title: Edit Note
            entities:
              - entity: input_select.jotty_note_picker
                name: Pick a note
              - type: divider
              - entity: input_text.jotty_edit_note_title
                name: Title
              - type: custom:lovelace-multiline-text-input-card
                entity: input_text.jotty_edit_note_content
                autosave: true
                show_success_messages: false
                buttons: false
            footer:
              type: buttons
              entities:
                - entity: script.jotty_save_edited_note
                  name: Save
                  icon: mdi:content-save
                - entity: script.jotty_delete_edited_note
                  name: Delete
                  icon: mdi:delete
                  tap_action:
                    action: call-service
                    service: script.jotty_delete_edited_note
                    confirmation:
                      text: Delete this note?
      - type: grid
        cards:
          - type: custom:html-template-card
            ignore_line_breaks: true
            content: |
              <style>
                @keyframes slideDown { from {top:40px;opacity:0;} to {top:60px;opacity:1;} }
                #jotty-loading {
                  display:none;
                  position:fixed;
                  top:60px;
                  left:50%;
                  transform:translateX(-50%);
                  z-index:9999;
                  background:#2196F3;
                  color:white;
                  padding:12px 24px;
                  border-radius:8px;
                  box-shadow:0 4px 12px rgba(0,0,0,0.3);
                  font-weight:600;
                  animation:slideDown 0.3s ease;
                }
                .notes-container { padding: 4px; }
                .note-card {
                  background: var(--ha-card-background, var(--card-background-color, white));
                  border: 1px solid var(--divider-color, #e0e0e0);
                  border-radius: 12px;
                  padding: 16px;
                  margin-bottom: 16px;
                  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                  transition: box-shadow 0.2s;
                }
                .note-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
                .note-title {
                  font-size: 1.4em;
                  font-weight: 600;
                  color: var(--primary-text-color);
                  margin-bottom: 12px;
                  padding-bottom: 8px;
                  border-bottom: 2px solid var(--primary-color);
                }
                .note-content {
                  color: var(--primary-text-color);
                  margin-bottom: 12px;
                  white-space: pre-wrap;
                  line-height: 1.6;
                  font-size: 1em;
                }
                .note-timestamp {
                  font-size: 0.85em;
                  color: var(--secondary-text-color);
                  font-style: italic;
                  text-align: right;
                }
              </style>
              <div id="jotty-loading">‚è≥ Processing...</div>
              <script>
                (function checkLoading(){
                  var banner=document.getElementById('jotty-loading');
                  if(banner){
                    var el=document.querySelector('home-assistant');
                    if(el&&el.hass&&el.hass.states['input_boolean.jotty_is_loading']){
                      var state=el.hass.states['input_boolean.jotty_is_loading'].state;
                      banner.style.display=state==='on'?'block':'none';
                    }
                  }
                  setTimeout(checkLoading,300);
                })();
              </script>
              <div class="notes-container">
                {% set ns = namespace(count=0, notes=[]) %}
                {% for state in states.sensor %}
                  {% if state.name.startswith('Jotty Note:') and state.state != 'unavailable' %}
                    {% set ns.notes = ns.notes + [state] %}
                  {% endif %}
                {% endfor %}
                {% for state in ns.notes | sort(attribute='attributes.updated', reverse=true) %}
                  {% set ns.count = ns.count + 1 %}
                  {% if ns.count is odd %}
                    {% set note_id = state_attr(state.entity_id, 'note_id') %}
                    <div class="note-card">
                      <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:12px;">
                        <div class="note-title" style="flex-grow:1; margin-bottom:0; padding-bottom:8px; border-bottom:none;">{{ state.state }}</div>
                        <button style="padding:4px 12px; background:var(--error-color,#ff5555); color:white; border:none; border-radius:4px; cursor:pointer; font-size:0.85em;" onclick="if(confirm('Delete {{ state.state }}?')){this.disabled=true; const el=document.querySelector('home-assistant'); if(el&&el.hass){el.hass.callService('jotty','delete_note',{note_id:'{{ note_id }}'});}}">üóëÔ∏è</button>
                      </div>
                      <div class="note-content">{{ state_attr(state.entity_id, 'content') }}</div>
                      <div class="note-timestamp">
                        Updated {{ relative_time(strptime(state_attr(state.entity_id, 'updated'), '%Y-%m-%dT%H:%M:%S.%fZ')) }} ago
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
      - type: grid
        cards:
          - type: custom:html-template-card
            ignore_line_breaks: true
            content: |
              <style>
                .notes-container { padding: 4px; }
                .note-card {
                  background: var(--ha-card-background, var(--card-background-color, white));
                  border: 1px solid var(--divider-color, #e0e0e0);
                  border-radius: 12px;
                  padding: 16px;
                  margin-bottom: 16px;
                  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                  transition: box-shadow 0.2s;
                }
                .note-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
                .note-title {
                  font-size: 1.4em;
                  font-weight: 600;
                  color: var(--primary-text-color);
                  margin-bottom: 12px;
                  padding-bottom: 8px;
                  border-bottom: 2px solid var(--primary-color);
                }
                .note-content {
                  color: var(--primary-text-color);
                  margin-bottom: 12px;
                  white-space: pre-wrap;
                  line-height: 1.6;
                  font-size: 1em;
                }
                .note-timestamp {
                  font-size: 0.85em;
                  color: var(--secondary-text-color);
                  font-style: italic;
                  text-align: right;
                }
              </style>
              <div class="notes-container">
                {% set ns = namespace(count=0, notes=[]) %}
                {% for state in states.sensor %}
                  {% if state.name.startswith('Jotty Note:') and state.state != 'unavailable' %}
                    {% set ns.notes = ns.notes + [state] %}
                  {% endif %}
                {% endfor %}
                {% for state in ns.notes | sort(attribute='attributes.updated', reverse=true) %}
                  {% set ns.count = ns.count + 1 %}
                  {% if ns.count is even %}
                    {% set note_id = state_attr(state.entity_id, 'note_id') %}
                    <div class="note-card">
                      <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:12px;">
                        <div class="note-title" style="flex-grow:1; margin-bottom:0; padding-bottom:8px; border-bottom:none;">{{ state.state }}</div>
                        <button style="padding:4px 12px; background:var(--error-color,#ff5555); color:white; border:none; border-radius:4px; cursor:pointer; font-size:0.85em;" onclick="if(confirm('Delete {{ state.state }}?')){this.disabled=true; const el=document.querySelector('home-assistant'); if(el&&el.hass){el.hass.callService('jotty','delete_note',{note_id:'{{ note_id }}'});}}">üóëÔ∏è</button>
                      </div>
                      <div class="note-content">{{ state_attr(state.entity_id, 'content') }}</div>
                      <div class="note-timestamp">
                        Updated {{ relative_time(strptime(state_attr(state.entity_id, 'updated'), '%Y-%m-%dT%H:%M:%S.%fZ')) }} ago
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
  - title: Lists
    path: lists
    icon: mdi:format-list-checks
    sections:
      - type: grid
        cards:
          - type: entities
            title: New List
            entities:
              - entity: input_text.jotty_checklist_title
                name: Title
            footer:
              type: buttons
              entities:
                - entity: script.jotty_create_checklist
                  name: Create
                  icon: mdi:plus-circle
            grid_options:
              columns: full
              rows: auto
      - type: grid
        cards:
          - type: custom:html-template-card
            ignore_line_breaks: true
            content: |
              <style>
                @keyframes slideDown { from {top:40px;opacity:0;} to {top:60px;opacity:1;} }
                #jotty-loading-lists {
                  display:none;
                  position:fixed;
                  top:60px;
                  left:50%;
                  transform:translateX(-50%);
                  z-index:9999;
                  background:#4CAF50;
                  color:white;
                  padding:12px 24px;
                  border-radius:8px;
                  box-shadow:0 4px 12px rgba(0,0,0,0.3);
                  font-weight:600;
                  animation:slideDown 0.3s ease;
                }
                .lists-container { padding: 4px; }
                .list-card {
                  background: var(--ha-card-background, var(--card-background-color, white));
                  border: 1px solid var(--divider-color, #e0e0e0);
                  border-radius: 12px;
                  padding: 16px;
                  margin-bottom: 20px;
                  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                }
                .list-header {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 12px;
                  padding-bottom: 12px;
                  border-bottom: 2px solid var(--primary-color);
                }
                .list-title { font-size: 1.4em; font-weight: 600; color: var(--primary-text-color); }
                .list-progress {
                  font-size: 0.9em;
                  background: var(--primary-color);
                  color: white;
                  padding: 4px 12px;
                  border-radius: 12px;
                }
                .list-items { margin-top: 12px; }
                .list-item {
                  display: flex;
                  align-items: center;
                  padding: 8px;
                  margin-bottom: 8px;
                  background: var(--secondary-background-color, #f5f5f5);
                  border-radius: 8px;
                  gap: 12px;
                  transition: opacity 0.2s;
                }
                .list-item:hover { background: var(--divider-color, #e0e0e0); }
                .item-checkbox { width: 24px; height: 24px; cursor: pointer; flex-shrink: 0; }
                .item-checkbox:disabled { cursor: wait; }
                .item-text { flex-grow: 1; color: var(--primary-text-color); font-size: 1em; }
                .item-text.completed { text-decoration: line-through; opacity: 0.6; }
                .add-item-section {
                  margin-top: 16px;
                  padding-top: 12px;
                  border-top: 1px solid var(--divider-color);
                  display: flex;
                  gap: 8px;
                }
                .add-item-input {
                  flex-grow: 1;
                  padding: 8px 12px;
                  border: 1px solid var(--divider-color);
                  border-radius: 4px;
                  background: var(--card-background-color);
                  color: var(--primary-text-color);
                  font-size: 1em;
                }
                .add-item-btn {
                  padding: 8px 16px;
                  background: var(--primary-color);
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 0.9em;
                }
                .add-item-btn:hover { opacity: 0.9; }
                .add-item-btn:disabled { opacity: 0.5; cursor: not-allowed; }
                .delete-list-btn {
                  padding: 4px 12px;
                  background: var(--error-color, #ff5555);
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 0.85em;
                }
              </style>
              <div id="jotty-loading-lists">‚è≥ Processing...</div>
              <script>
                (function checkLoading(){
                  var banner=document.getElementById('jotty-loading-lists');
                  if(banner){
                    var el=document.querySelector('home-assistant');
                    if(el&&el.hass&&el.hass.states['input_boolean.jotty_is_loading']){
                      var state=el.hass.states['input_boolean.jotty_is_loading'].state;
                      banner.style.display=state==='on'?'block':'none';
                    }
                  }
                  setTimeout(checkLoading,300);
                })();
              </script>
              <div class="lists-container">
                {% set ns = namespace(count=0, lists=[]) %}
                {% for state in states.sensor %}
                  {% if state.name.startswith('Jotty List:') and state.state != 'unavailable' %}
                    {% set list_type = state_attr(state.entity_id, 'type') %}
                    {% if list_type != 'task' %}
                      {% set ns.lists = ns.lists + [state] %}
                    {% endif %}
                  {% endif %}
                {% endfor %}
                {% for state in ns.lists | sort(attribute='attributes.updated', reverse=true) %}
                  {% set ns.count = ns.count + 1 %}
                  {% if ns.count is odd %}
                    {% set list_id = state_attr(state.entity_id, 'checklist_id') %}
                    {% set list_title = state_attr(state.entity_id, 'title') %}
                    {% set items = state_attr(state.entity_id, 'items') or [] %}
                    {% set completed = state_attr(state.entity_id, 'completed') %}
                    {% set total = state_attr(state.entity_id, 'total') %}
                    <div class="list-card">
                      <div class="list-header">
                        <div class="list-title">{{ list_title }}</div>
                        <div class="list-progress">{{ completed }}/{{ total }}</div>
                      </div>
                      <div class="list-items">
                        {% for item in items %}
                          <div class="list-item">
                            <input type="checkbox" class="item-checkbox" {{ 'checked' if item.completed else '' }} onchange="(function(cb){cb.disabled=true;cb.parentElement.style.opacity='0.5';const act=cb.checked?'check':'uncheck';const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_action_data',value:'{{ list_id }}|||{{ loop.index0 }}|||'+act});}setTimeout(function(){cb.disabled=false;cb.parentElement.style.opacity='1';},1000);})(this);">
                            <span class="item-text {{ 'completed' if item.completed else '' }}">{{ item.text }}</span>
                            <button style="padding:2px 8px;background:var(--error-color,#ff5555);color:white;border:none;border-radius:4px;cursor:pointer;font-size:0.8em;" onclick="if(confirm('Delete this item?')){(function(btn){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_delete_item_data',value:'{{ list_id }}|||{{ loop.index0 }}'});}})(this);}">üóëÔ∏è</button>
                          </div>
                        {% endfor %}
                      </div>
                      <div class="add-item-section">
                        <input type="text" class="add-item-input" placeholder="Add new item...">
                        <button class="add-item-btn" onclick="(function(btn){const inp=btn.previousElementSibling;if(!inp.value.trim()){inp.placeholder='Type something first!';setTimeout(function(){inp.placeholder='Add new item...';},2000);return;}const txt=inp.value.trim();inp.value='';inp.placeholder='Adding...';btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_action_data',value:'{{ list_id }}|||add|||'+txt});}setTimeout(function(){inp.placeholder='Add new item...';btn.disabled=false;},2000);})(this);">‚ûï Add</button>
                        <button class="delete-list-btn" onclick="if(confirm('Delete {{ list_title }}?')){(function(btn){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_action_data',value:'{{ list_id }}|||delete'});}})(this);}">üóëÔ∏è</button>
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
      - type: grid
        cards:
          - type: custom:html-template-card
            ignore_line_breaks: true
            content: |
              <style>
                .lists-container { padding: 4px; }
                .list-card {
                  background: var(--ha-card-background, var(--card-background-color, white));
                  border: 1px solid var(--divider-color, #e0e0e0);
                  border-radius: 12px;
                  padding: 16px;
                  margin-bottom: 20px;
                  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                }
                .list-header {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 12px;
                  padding-bottom: 12px;
                  border-bottom: 2px solid var(--primary-color);
                }
                .list-title { font-size: 1.4em; font-weight: 600; color: var(--primary-text-color); }
                .list-progress {
                  font-size: 0.9em;
                  background: var(--primary-color);
                  color: white;
                  padding: 4px 12px;
                  border-radius: 12px;
                }
                .list-items { margin-top: 12px; }
                .list-item {
                  display: flex;
                  align-items: center;
                  padding: 8px;
                  margin-bottom: 8px;
                  background: var(--secondary-background-color, #f5f5f5);
                  border-radius: 8px;
                  gap: 12px;
                  transition: opacity 0.2s;
                }
                .list-item:hover { background: var(--divider-color, #e0e0e0); }
                .item-checkbox { width: 24px; height: 24px; cursor: pointer; flex-shrink: 0; }
                .item-checkbox:disabled { cursor: wait; }
                .item-text { flex-grow: 1; color: var(--primary-text-color); font-size: 1em; }
                .item-text.completed { text-decoration: line-through; opacity: 0.6; }
                .add-item-section {
                  margin-top: 16px;
                  padding-top: 12px;
                  border-top: 1px solid var(--divider-color);
                  display: flex;
                  gap: 8px;
                }
                .add-item-input {
                  flex-grow: 1;
                  padding: 8px 12px;
                  border: 1px solid var(--divider-color);
                  border-radius: 4px;
                  background: var(--card-background-color);
                  color: var(--primary-text-color);
                  font-size: 1em;
                }
                .add-item-btn {
                  padding: 8px 16px;
                  background: var(--primary-color);
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 0.9em;
                }
                .add-item-btn:hover { opacity: 0.9; }
                .add-item-btn:disabled { opacity: 0.5; cursor: not-allowed; }
                .delete-list-btn {
                  padding: 4px 12px;
                  background: var(--error-color, #ff5555);
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 0.85em;
                }
              </style>
              <div class="lists-container">
                {% set ns = namespace(count=0, lists=[]) %}
                {% for state in states.sensor %}
                  {% if state.name.startswith('Jotty List:') and state.state != 'unavailable' %}
                    {% set list_type = state_attr(state.entity_id, 'type') %}
                    {% if list_type != 'task' %}
                      {% set ns.lists = ns.lists + [state] %}
                    {% endif %}
                  {% endif %}
                {% endfor %}
                {% for state in ns.lists | sort(attribute='attributes.updated', reverse=true) %}
                  {% set ns.count = ns.count + 1 %}
                  {% if ns.count is even %}
                    {% set list_id = state_attr(state.entity_id, 'checklist_id') %}
                    {% set list_title = state_attr(state.entity_id, 'title') %}
                    {% set items = state_attr(state.entity_id, 'items') or [] %}
                    {% set completed = state_attr(state.entity_id, 'completed') %}
                    {% set total = state_attr(state.entity_id, 'total') %}
                    <div class="list-card">
                      <div class="list-header">
                        <div class="list-title">{{ list_title }}</div>
                        <div class="list-progress">{{ completed }}/{{ total }}</div>
                      </div>
                      <div class="list-items">
                        {% for item in items %}
                          <div class="list-item">
                            <input type="checkbox" class="item-checkbox" {{ 'checked' if item.completed else '' }} onchange="(function(cb){cb.disabled=true;cb.parentElement.style.opacity='0.5';const act=cb.checked?'check':'uncheck';const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_action_data',value:'{{ list_id }}|||{{ loop.index0 }}|||'+act});}setTimeout(function(){cb.disabled=false;cb.parentElement.style.opacity='1';},1000);})(this);">
                            <span class="item-text {{ 'completed' if item.completed else '' }}">{{ item.text }}</span>
                            <button style="padding:2px 8px;background:var(--error-color,#ff5555);color:white;border:none;border-radius:4px;cursor:pointer;font-size:0.8em;" onclick="if(confirm('Delete this item?')){(function(btn){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_delete_item_data',value:'{{ list_id }}|||{{ loop.index0 }}'});}})(this);}">üóëÔ∏è</button>
                          </div>
                        {% endfor %}
                      </div>
                      <div class="add-item-section">
                        <input type="text" class="add-item-input" placeholder="Add new item...">
                        <button class="add-item-btn" onclick="(function(btn){const inp=btn.previousElementSibling;if(!inp.value.trim()){inp.placeholder='Type something first!';setTimeout(function(){inp.placeholder='Add new item...';},2000);return;}const txt=inp.value.trim();inp.value='';inp.placeholder='Adding...';btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_action_data',value:'{{ list_id }}|||add|||'+txt});}setTimeout(function(){inp.placeholder='Add new item...';btn.disabled=false;},2000);})(this);">‚ûï Add</button>
                        <button class="delete-list-btn" onclick="if(confirm('Delete {{ list_title }}?')){(function(btn){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_action_data',value:'{{ list_id }}|||delete'});}})(this);}">üóëÔ∏è</button>
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
  - title: Tasks
    path: tasks
    icon: mdi:clipboard-list
    sections:
      - type: grid
        cards:
          - type: entities
            title: New Task List
            entities:
              - entity: input_text.jotty_task_title
                name: Title
            footer:
              type: buttons
              entities:
                - entity: script.jotty_create_task
                  name: Create
                  icon: mdi:plus-circle
            grid_options:
              columns: full
              rows: auto
      - type: grid
        cards:
          - type: custom:html-template-card
            ignore_line_breaks: true
            content: |
              <style>
                @keyframes slideDown { from {top:40px;opacity:0;} to {top:60px;opacity:1;} }
                #jotty-loading-tasks {
                  display:none;
                  position:fixed;
                  top:60px;
                  left:50%;
                  transform:translateX(-50%);
                  z-index:9999;
                  background:#9C27B0;
                  color:white;
                  padding:12px 24px;
                  border-radius:8px;
                  box-shadow:0 4px 12px rgba(0,0,0,0.3);
                  font-weight:600;
                  animation:slideDown 0.3s ease;
                }
                .tasks-container { padding: 4px; }
                .task-card {
                  background: var(--ha-card-background, var(--card-background-color, white));
                  border: 1px solid var(--divider-color, #e0e0e0);
                  border-radius: 12px;
                  padding: 16px;
                  margin-bottom: 20px;
                  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                }
                .task-header {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 12px;
                  padding-bottom: 12px;
                  border-bottom: 2px solid #9C27B0;
                }
                .task-title { font-size: 1.4em; font-weight: 600; color: var(--primary-text-color); }
                .task-progress {
                  font-size: 0.9em;
                  background: #9C27B0;
                  color: white;
                  padding: 4px 12px;
                  border-radius: 12px;
                }
                .task-items { margin-top: 12px; }
                .task-item {
                  display: flex;
                  align-items: center;
                  padding: 8px;
                  margin-bottom: 4px;
                  background: var(--secondary-background-color, #f5f5f5);
                  border-radius: 8px;
                  gap: 8px;
                }
                .task-item:hover { background: var(--divider-color, #e0e0e0); }
                .task-item.depth-1 { margin-left: 24px; border-left: 3px solid #673AB7; }
                .task-item.depth-2 { margin-left: 48px; border-left: 3px solid #9575CD; }
                .task-item.depth-3 { margin-left: 72px; border-left: 3px solid #B39DDB; }
                .task-item-text { flex-grow: 1; color: var(--primary-text-color); font-size: 1em; }
                .task-item-text.completed { text-decoration: line-through; opacity: 0.6; }
                .task-status-select {
                  padding: 4px 8px;
                  border-radius: 4px;
                  border: 1px solid var(--divider-color);
                  background: var(--card-background-color);
                  color: var(--primary-text-color);
                  font-size: 0.85em;
                  cursor: pointer;
                }
                .delete-item-btn {
                  padding: 2px 8px;
                  background: var(--error-color, #ff5555);
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 0.8em;
                }
                .add-sub-btn {
                  padding: 2px 6px;
                  background: #673AB7;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 0.75em;
                }
                .add-task-section {
                  margin-top: 16px;
                  padding-top: 12px;
                  border-top: 1px solid var(--divider-color);
                  display: flex;
                  gap: 8px;
                  flex-wrap: wrap;
                }
                .add-task-input {
                  flex-grow: 1;
                  min-width: 150px;
                  padding: 8px 12px;
                  border: 1px solid var(--divider-color);
                  border-radius: 4px;
                  background: var(--card-background-color);
                  color: var(--primary-text-color);
                }
                .add-task-btn {
                  padding: 8px 16px;
                  background: #9C27B0;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                }
                .delete-task-btn {
                  padding: 4px 12px;
                  background: var(--error-color, #ff5555);
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                }
                .kanban-btn {
                  padding: 4px 12px;
                  background: #673AB7;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                }
                .status-todo { border-left: 3px solid #ff9800; }
                .status-in_progress { border-left: 3px solid #2196F3; }
                .status-completed { border-left: 3px solid #4CAF50; }
                .status-section {
                  margin-top: 12px;
                  padding: 12px;
                  background: var(--secondary-background-color);
                  border-radius: 8px;
                  display: none;
                }
                .status-section.show { display: block; }
                .status-list { margin: 8px 0; }
                .status-item {
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  padding: 6px;
                  background: var(--card-background-color);
                  border-radius: 4px;
                  margin-bottom: 4px;
                }
                .status-color {
                  width: 20px;
                  height: 20px;
                  border-radius: 4px;
                  flex-shrink: 0;
                }
                .status-name { flex-grow: 1; font-weight: 500; }
                .status-id { font-size: 0.8em; color: var(--secondary-text-color); }
                .new-status-form {
                  display: flex;
                  gap: 8px;
                  flex-wrap: wrap;
                  margin-top: 8px;
                  padding-top: 8px;
                  border-top: 1px solid var(--divider-color);
                }
                .new-status-form input {
                  padding: 6px 10px;
                  border: 1px solid var(--divider-color);
                  border-radius: 4px;
                  background: var(--card-background-color);
                  color: var(--primary-text-color);
                }
                .new-status-form input[type="color"] {
                  width: 40px;
                  padding: 2px;
                }
              </style>
              <div id="jotty-loading-tasks">‚è≥ Processing...</div>
              <script>
                (function checkLoading(){
                  var banner=document.getElementById('jotty-loading-tasks');
                  if(banner){
                    var el=document.querySelector('home-assistant');
                    if(el&&el.hass&&el.hass.states['input_boolean.jotty_is_loading']){
                      banner.style.display=el.hass.states['input_boolean.jotty_is_loading'].state==='on'?'block':'none';
                    }
                  }
                  setTimeout(checkLoading,300);
                })();
              </script>
              <div class="tasks-container">
                {% set ns = namespace(count=0, tasks=[]) %}
                {% for state in states.sensor %}
                  {% if state.name.startswith('Jotty Task:') and state.state != 'unavailable' %}
                    {% set ns.tasks = ns.tasks + [state] %}
                  {% endif %}
                {% endfor %}
                {% for state in ns.tasks | sort(attribute='attributes.updated', reverse=true) %}
                  {% set ns.count = ns.count + 1 %}
                  {% if ns.count is odd %}
                    {% set task_id = state_attr(state.entity_id, 'task_id') %}
                    {% set task_title = state_attr(state.entity_id, 'title') %}
                    {% set flat_items = state_attr(state.entity_id, 'flat_items') or [] %}
                    {% set statuses = state_attr(state.entity_id, 'statuses') or [{'id':'todo','name':'To Do','order':0},{'id':'in_progress','name':'In Progress','order':1},{'id':'completed','name':'Completed','order':2}] %}
                    {% set completed = state_attr(state.entity_id, 'completed') %}
                    {% set total = state_attr(state.entity_id, 'total') %}
                    <div class="task-card">
                      <div class="task-header">
                        <div class="task-title">{{ task_title }}</div>
                        <div class="task-progress">{{ completed }}/{{ total }}</div>
                      </div>
                      <div class="task-items">
                        {% for item in flat_items %}
                          {% set index_path = item.index_path | default('0') %}
                          {% set depth = index_path.split('.') | length - 1 %}
                          <div class="task-item depth-{{ depth }} status-{{ item.status }}">
                            <span class="task-item-text {{ 'completed' if item.status == 'completed' else '' }}">{{ item.text }}</span>
                            <select class="task-status-select" onchange="(function(sel){sel.disabled=true;sel.parentElement.style.opacity='0.5';const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||{{ index_path }}|||status|||'+sel.value});}setTimeout(function(){sel.disabled=false;sel.parentElement.style.opacity='1';},1000);})(this);">
                              {% for status in statuses | sort(attribute='order') %}
                                <option value="{{ status.id }}" {{ 'selected' if item.status == status.id else '' }}>{{ status.name }}</option>
                              {% endfor %}
                            </select>
                            <button class="add-sub-btn" title="Add sub-task" onclick="(function(btn){const txt=prompt('Enter sub-task:');if(txt&&txt.trim()){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||add|||'+txt.trim()+'|||todo|||{{ index_path }}'});}}})(this);">‚ûï</button>
                            <button class="delete-item-btn" onclick="if(confirm('Delete?')){const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||{{ index_path }}|||delete_item'});}}">üóëÔ∏è</button>
                          </div>
                        {% endfor %}
                      </div>
                      <div class="add-task-section">
                        <input type="text" class="add-task-input" placeholder="Add new task...">
                        <select class="task-status-select" style="min-width:100px;">
                          {% for status in statuses | sort(attribute='order') %}
                            <option value="{{ status.id }}">{{ status.name }}</option>
                          {% endfor %}
                        </select>
                        <button class="add-task-btn" onclick="(function(btn){const inp=btn.parentElement.querySelector('.add-task-input');const sel=btn.parentElement.querySelector('.task-status-select');if(!inp.value.trim())return;const txt=inp.value.trim();const st=sel.value;inp.value='';btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||add|||'+txt+'|||'+st});}setTimeout(function(){btn.disabled=false;},2000);})(this);">‚ûï Add</button>
                        <button class="kanban-btn" onclick="(function(btn){var panel=btn.closest('.task-card').querySelector('.status-section');if(panel){panel.classList.toggle('show');}})(this);">‚öôÔ∏è Columns</button>
                        <button class="delete-task-btn" onclick="if(confirm('Delete {{ task_title }}?')){const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||delete'});}}">üóëÔ∏è</button>
                      </div>
                      <div class="status-section">
                        <strong>üìä Kanban Columns</strong>
                        <div class="status-list">
                          {% for status in statuses | sort(attribute='order') %}
                            <div class="status-item">
                              <div class="status-color" style="background:{{ status.color if status.color else '#888' }};"></div>
                              <span class="status-name">{{ status.name }}</span>
                              <span class="status-id">({{ status.id }})</span>
                              <button style="padding:2px 6px;background:#ff9800;color:white;border:none;border-radius:4px;cursor:pointer;font-size:0.75em;" onclick="(function(btn){const newLabel=prompt('New label:','{{ status.name }}');if(newLabel&&newLabel.trim()){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_kanban_action_data',value:'update_status|||{{ task_id }}|||{{ status.id }}|||'+newLabel.trim()});}}})(this);">‚úèÔ∏è</button>
                              {% if statuses | length > 1 %}
                              <button style="padding:2px 6px;background:var(--error-color);color:white;border:none;border-radius:4px;cursor:pointer;font-size:0.75em;" onclick="if(confirm('Delete {{ status.name }}?')){const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_kanban_action_data',value:'delete_status|||{{ task_id }}|||{{ status.id }}'});}}">üóëÔ∏è</button>
                              {% endif %}
                            </div>
                          {% endfor %}
                        </div>
                        <div class="new-status-form">
                          <input type="text" placeholder="ID (e.g. review)" style="width:100px;" class="new-status-id">
                          <input type="text" placeholder="Label" style="width:120px;" class="new-status-label">
                          <input type="color" value="#3b82f6" class="new-status-color">
                          <button class="add-task-btn" style="padding:6px 12px;" onclick="(function(btn){const form=btn.closest('.new-status-form');const idInp=form.querySelector('.new-status-id');const labelInp=form.querySelector('.new-status-label');const colorInp=form.querySelector('.new-status-color');if(!idInp.value.trim()||!labelInp.value.trim()){alert('ID and Label required');return;}btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_kanban_action_data',value:'create_status|||{{ task_id }}|||'+idInp.value.trim()+'|||'+labelInp.value.trim()+'|||'+colorInp.value});}idInp.value='';labelInp.value='';setTimeout(function(){btn.disabled=false;},2000);})(this);">‚ûï Add Column</button>
                        </div>
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
      - type: grid
        cards:
          - type: custom:html-template-card
            ignore_line_breaks: true
            content: |
              <style>
                .tasks-container { padding: 4px; }
                .task-card { background: var(--ha-card-background); border: 1px solid var(--divider-color); border-radius: 12px; padding: 16px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
                .task-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 2px solid #9C27B0; }
                .task-title { font-size: 1.4em; font-weight: 600; }
                .task-progress { font-size: 0.9em; background: #9C27B0; color: white; padding: 4px 12px; border-radius: 12px; }
                .task-items { margin-top: 12px; }
                .task-item { display: flex; align-items: center; padding: 8px; margin-bottom: 4px; background: var(--secondary-background-color); border-radius: 8px; gap: 8px; }
                .task-item:hover { background: var(--divider-color); }
                .task-item.depth-1 { margin-left: 24px; border-left: 3px solid #673AB7; }
                .task-item.depth-2 { margin-left: 48px; border-left: 3px solid #9575CD; }
                .task-item.depth-3 { margin-left: 72px; border-left: 3px solid #B39DDB; }
                .task-item-text { flex-grow: 1; }
                .task-item-text.completed { text-decoration: line-through; opacity: 0.6; }
                .task-status-select { padding: 4px 8px; border-radius: 4px; border: 1px solid var(--divider-color); background: var(--card-background-color); color: var(--primary-text-color); font-size: 0.85em; cursor: pointer; }
                .delete-item-btn { padding: 2px 8px; background: var(--error-color); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em; }
                .add-sub-btn { padding: 2px 6px; background: #673AB7; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.75em; }
                .add-task-section { margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--divider-color); display: flex; gap: 8px; flex-wrap: wrap; }
                .add-task-input { flex-grow: 1; min-width: 150px; padding: 8px 12px; border: 1px solid var(--divider-color); border-radius: 4px; background: var(--card-background-color); color: var(--primary-text-color); }
                .add-task-btn { padding: 8px 16px; background: #9C27B0; color: white; border: none; border-radius: 4px; cursor: pointer; }
                .delete-task-btn { padding: 4px 12px; background: var(--error-color); color: white; border: none; border-radius: 4px; cursor: pointer; }
                .kanban-btn { padding: 4px 12px; background: #673AB7; color: white; border: none; border-radius: 4px; cursor: pointer; }
                .status-todo { border-left: 3px solid #ff9800; }
                .status-in_progress { border-left: 3px solid #2196F3; }
                .status-completed { border-left: 3px solid #4CAF50; }
                .status-section { margin-top: 12px; padding: 12px; background: var(--secondary-background-color); border-radius: 8px; display: none; }
                .status-section.show { display: block; }
                .status-list { margin: 8px 0; }
                .status-item { display: flex; align-items: center; gap: 8px; padding: 6px; background: var(--card-background-color); border-radius: 4px; margin-bottom: 4px; }
                .status-color { width: 20px; height: 20px; border-radius: 4px; }
                .status-name { flex-grow: 1; font-weight: 500; }
                .status-id { font-size: 0.8em; color: var(--secondary-text-color); }
                .new-status-form { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--divider-color); }
                .new-status-form input { padding: 6px 10px; border: 1px solid var(--divider-color); border-radius: 4px; background: var(--card-background-color); color: var(--primary-text-color); }
                .new-status-form input[type="color"] { width: 40px; padding: 2px; }
              </style>
              <div class="tasks-container">
                {% set ns = namespace(count=0, tasks=[]) %}
                {% for state in states.sensor %}
                  {% if state.name.startswith('Jotty Task:') and state.state != 'unavailable' %}
                    {% set ns.tasks = ns.tasks + [state] %}
                  {% endif %}
                {% endfor %}
                {% for state in ns.tasks | sort(attribute='attributes.updated', reverse=true) %}
                  {% set ns.count = ns.count + 1 %}
                  {% if ns.count is even %}
                    {% set task_id = state_attr(state.entity_id, 'task_id') %}
                    {% set task_title = state_attr(state.entity_id, 'title') %}
                    {% set flat_items = state_attr(state.entity_id, 'flat_items') or [] %}
                    {% set statuses = state_attr(state.entity_id, 'statuses') or [{'id':'todo','name':'To Do','order':0},{'id':'in_progress','name':'In Progress','order':1},{'id':'completed','name':'Completed','order':2}] %}
                    {% set completed = state_attr(state.entity_id, 'completed') %}
                    {% set total = state_attr(state.entity_id, 'total') %}
                    <div class="task-card">
                      <div class="task-header">
                        <div class="task-title">{{ task_title }}</div>
                        <div class="task-progress">{{ completed }}/{{ total }}</div>
                      </div>
                      <div class="task-items">
                        {% for item in flat_items %}
                          {% set index_path = item.index_path | default('0') %}
                          {% set depth = index_path.split('.') | length - 1 %}
                          <div class="task-item depth-{{ depth }} status-{{ item.status }}">
                            <span class="task-item-text {{ 'completed' if item.status == 'completed' else '' }}">{{ item.text }}</span>
                            <select class="task-status-select" onchange="(function(sel){sel.disabled=true;sel.parentElement.style.opacity='0.5';const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||{{ index_path }}|||status|||'+sel.value});}})(this);">
                              {% for status in statuses | sort(attribute='order') %}
                                <option value="{{ status.id }}" {{ 'selected' if item.status == status.id else '' }}>{{ status.name }}</option>
                              {% endfor %}
                            </select>
                            <button class="add-sub-btn" title="Add sub-task" onclick="(function(btn){const txt=prompt('Enter sub-task:');if(txt&&txt.trim()){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||add|||'+txt.trim()+'|||todo|||{{ index_path }}'});}}})(this);">‚ûï</button>
                            <button class="delete-item-btn" onclick="if(confirm('Delete?')){const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||{{ index_path }}|||delete_item'});}}">üóëÔ∏è</button>
                          </div>
                        {% endfor %}
                      </div>
                      <div class="add-task-section">
                        <input type="text" class="add-task-input" placeholder="Add new task...">
                        <select class="task-status-select" style="min-width:100px;">
                          {% for status in statuses | sort(attribute='order') %}
                            <option value="{{ status.id }}">{{ status.name }}</option>
                          {% endfor %}
                        </select>
                        <button class="add-task-btn" onclick="(function(btn){const inp=btn.parentElement.querySelector('.add-task-input');const sel=btn.parentElement.querySelector('.task-status-select');if(!inp.value.trim())return;const txt=inp.value.trim();const st=sel.value;inp.value='';btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||add|||'+txt+'|||'+st});}setTimeout(function(){btn.disabled=false;},2000);})(this);">‚ûï Add</button>
                        <button class="kanban-btn" onclick="(function(btn){var panel=btn.closest('.task-card').querySelector('.status-section');if(panel){panel.classList.toggle('show');}})(this);">‚öôÔ∏è Columns</button>
                        <button class="delete-task-btn" onclick="if(confirm('Delete {{ task_title }}?')){const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_quick_task_action_data',value:'{{ task_id }}|||delete'});}}">üóëÔ∏è</button>
                      </div>
                      <div class="status-section">
                        <strong>üìä Kanban Columns</strong>
                        <div class="status-list">
                          {% for status in statuses | sort(attribute='order') %}
                            <div class="status-item">
                              <div class="status-color" style="background:{{ status.color if status.color else '#888' }};"></div>
                              <span class="status-name">{{ status.name }}</span>
                              <span class="status-id">({{ status.id }})</span>
                              <button style="padding:2px 6px;background:#ff9800;color:white;border:none;border-radius:4px;cursor:pointer;font-size:0.75em;" onclick="(function(btn){const newLabel=prompt('New label:','{{ status.name }}');if(newLabel&&newLabel.trim()){btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_kanban_action_data',value:'update_status|||{{ task_id }}|||{{ status.id }}|||'+newLabel.trim()});}}})(this);">‚úèÔ∏è</button>
                              {% if statuses | length > 1 %}
                              <button style="padding:2px 6px;background:var(--error-color);color:white;border:none;border-radius:4px;cursor:pointer;font-size:0.75em;" onclick="if(confirm('Delete {{ status.name }}?')){const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_kanban_action_data',value:'delete_status|||{{ task_id }}|||{{ status.id }}'});}}">üóëÔ∏è</button>
                              {% endif %}
                            </div>
                          {% endfor %}
                        </div>
                        <div class="new-status-form">
                          <input type="text" placeholder="ID (e.g. review)" style="width:100px;" class="new-status-id">
                          <input type="text" placeholder="Label" style="width:120px;" class="new-status-label">
                          <input type="color" value="#3b82f6" class="new-status-color">
                          <button class="add-task-btn" style="padding:6px 12px;" onclick="(function(btn){const form=btn.closest('.new-status-form');const idInp=form.querySelector('.new-status-id');const labelInp=form.querySelector('.new-status-label');const colorInp=form.querySelector('.new-status-color');if(!idInp.value.trim()||!labelInp.value.trim()){alert('ID and Label required');return;}btn.disabled=true;const el=document.querySelector('home-assistant');if(el&&el.hass){el.hass.callService('input_text','set_value',{entity_id:'input_text.jotty_kanban_action_data',value:'create_status|||{{ task_id }}|||'+idInp.value.trim()+'|||'+labelInp.value.trim()+'|||'+colorInp.value});}idInp.value='';labelInp.value='';setTimeout(function(){btn.disabled=false;},2000);})(this);">‚ûï Add Column</button>
                        </div>
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
  - title: Quick
    path: quick
    icon: mdi:lightning-bolt
    cards:
      - type: markdown
        content: |
          # Quick Actions
          One-tap notes and lists!
      - type: button
        name: Refresh All Data
        icon: mdi:refresh
        tap_action:
          action: call-service
          service: script.jotty_refresh_dashboard_data
        show_state: false
      - type: grid
        columns: 2
        cards:
          - type: button
            name: Shopping List
            icon: mdi:cart
            tap_action:
              action: call-service
              service: jotty.create_checklist
              service_data:
                title: Shopping List
                type: simple
          - type: button
            name: To-Do Today
            icon: mdi:calendar-today
            tap_action:
              action: call-service
              service: jotty.create_task
              service_data:
                title: '{{ now().strftime(''%A'') }} Tasks'
          - type: button
            name: Quick Note
            icon: mdi:note-plus
            tap_action:
              action: call-service
              service: jotty.create_note
              service_data:
                title: 'Note: {{ now().strftime(''%H:%M'') }}'
                content: ''
          - type: button
            name: Reminder
            icon: mdi:bell
            tap_action:
              action: call-service
              service: jotty.create_note
              service_data:
                title: Reminder
                content: Don't forget to...
          - type: button
            name: Meal Plan
            icon: mdi:food
            tap_action:
              action: call-service
              service: jotty.create_note
              service_data:
                title: Meal Plan
                content: |-
                  Monday:
                  Tuesday:
                  Wednesday:
          - type: button
            name: Packing List
            icon: mdi:bag-checked
            tap_action:
              action: call-service
              service: jotty.create_checklist
              service_data:
                title: Packing List
                type: simple
          - type: button
            name: New Task List
            icon: mdi:clipboard-plus
            tap_action:
              action: call-service
              service: jotty.create_task
              service_data:
                title: Tasks {{ now().strftime('%m/%d') }}
          - type: button
            name: Update Dropdowns
            icon: mdi:sync
            tap_action:
              action: call-service
              service: script.jotty_update_both_dropdowns
          - type: button
            name: Force Refresh
            icon: mdi:database-refresh
            tap_action:
              action: call-service
              service: homeassistant.update_entity
              service_data:
                entity_id:
                  - sensor.jotty_total_notes
                  - sensor.jotty_total_checklists
                  - sensor.jotty_total_tasks
  - title: Stats
    path: stats
    icon: mdi:chart-box
    cards:
      - type: markdown
        content: |
          # Family Stats
      - type: horizontal-stack
        cards:
          - type: statistic
            entity: sensor.jotty_total_notes
            name: Notes
            stat_type: mean
            period: 999
          - type: statistic
            entity: sensor.jotty_total_checklists
            name: Lists
            stat_type: mean
            period: 999
          - type: statistic
            entity: sensor.jotty_total_tasks
            name: Tasks
            stat_type: mean
            period: 999
          - type: statistic
            entity: sensor.jotty_completion_rate
            name: Done
            unit: '%'
            stat_type: mean
            period: 999
      - type: horizontal-stack
        cards:
          - type: statistic
            entity: sensor.jotty_total_items
            name: Items
            stat_type: mean
            period: 99
          - type: statistic
            entity: sensor.jotty_completed_items
            name: Done
            stat_type: mean
            period: 99
          - type: statistic
            entity: sensor.jotty_pending_items
            name: Pending
            stat_type: mean
            period: 99
      - type: entities
        title: Detailed Statistics
        entities:
          - entity: sensor.jotty_total_notes
            name: Total Notes
            icon: mdi:note-text
          - entity: sensor.jotty_total_checklists
            name: Total Lists
            icon: mdi:format-list-checks
          - entity: sensor.jotty_total_tasks
            name: Total Tasks
            icon: mdi:clipboard-list
          - entity: sensor.jotty_total_items
            name: Total Items
            icon: mdi:checkbox-multiple-marked
          - entity: sensor.jotty_completed_items
            name: Completed Items
            icon: mdi:check-all
          - entity: sensor.jotty_pending_items
            name: Pending Items
            icon: mdi:clock-outline
          - entity: sensor.jotty_completion_rate
            name: Completion Rate
            icon: mdi:percent
